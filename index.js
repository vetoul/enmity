(()=>{function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n){window.enmity.settings.set(e,t,n)}let{components:n}=window.enmity;n.Alert;let o=n.Button;n.FlatList;let a=n.Image;n.ImageBackground,n.KeyboardAvoidingView,n.Modal,n.Pressable,n.RefreshControl;let r=n.ScrollView;n.SectionList,n.StatusBar,n.StyleSheet,n.Switch;let i=n.Text;n.TextInput,n.TouchableHighlight;let l=n.TouchableOpacity;n.TouchableWithoutFeedback,n.Touchable;let c=n.View;n.VirtualizedList,n.Form,n.FormArrow,n.FormCTA,n.FormCTAButton,n.FormCardSection,n.FormCheckbox;let s=n.FormDivider;n.FormHint,n.FormIcon;let u=n.FormInput;n.FormLabel,n.FormRadio;let d=n.FormRow,m=n.FormSection;n.FormSelect,n.FormSubLabel;let g=n.FormSwitch;n.FormTernaryCheckBox,n.FormText,n.FormTextColors,n.FormTextSizes;let f=(...e)=>window.enmity.modules.filters.byProps(...e);function p(...e){return window.enmity.modules.bulk(...e)}function h(...e){return window.enmity.modules.getByProps(...e)}window.enmity.modules.common;let y=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars;let v=window.enmity.modules.common.Native,b=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher;let w=window.enmity.modules.common.Storage,_=window.enmity.modules.common.Toasts,E=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token;let S=window.enmity.modules.common.REST;window.enmity.modules.common.Settings;let x=window.enmity.modules.common.Users,C=window.enmity.modules.common.Navigation,T=window.enmity.modules.common.NavigationNative,D=window.enmity.modules.common.NavigationStack;window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;let I=window.enmity.modules.common.StyleSheet,L=window.enmity.modules.common.ColorMap;window.enmity.modules.common.Components,window.enmity.modules.common.Locale;let A=window.enmity.modules.common.Profiles;window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;var P,M,B,N,O,R,k,F,U,j,V,G,Y,H,z=function(e){var t=0;for(var n in e)t++;return t};function W(e){return window.enmity.assets.getIDByName(e)}var J={Debug:W("debug"),Retry:W("ic_message_retry"),Failed:W("Small"),Cancel:W("ic_megaphone_nsfw_16px"),Add:W("add_white"),Delete:W("ic_message_delete"),Clear:W("ic_clear_all_24px"),Pencil:W("ic_pencil_24px"),Success:W("ic_selection_checked_24px"),Warning:W("ic_warning_24px"),Copy:W("toast_copy_link"),Open:W("ic_leave_stage"),Clipboard:W("pending-alert"),Initial:W("coffee"),Shield:W("ic_person_shield"),Debug_Command:{Sent:W("ic_application_command_24px"),Clock:W("clock")},Settings:{Toasts:{Context:W("toast_image_saved"),Settings:W("ic_selection_checked_24px")},Self:W("friends_toast_icon"),Share:W("share"),Robot:W("ic_robot_24px"),Commands:W("ic_profile_badge_bot_commands"),Debug:W("ic_rulebook_16px")}},X=function(e){_.open({content:"Copied ".concat(e," to clipboard."),source:J.Clipboard})},K=function(e){var t=e.split("\n").map(function(e){if(""!=e)return'"'.concat(e.replaceAll(":",'":"').replace(" ",""),'",')});return t[0]="{".concat(t[0]),t[z(t)]="".concat(t[z(t)],"}"),t=(t=(t=t.join("")).replaceAll("undefined","")).split("").reverse().join("").replace(",","").split("").reverse().join("")},q=function(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(6===l[0]&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},Q=function(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(6===l[0]&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};let{native:$}=window.enmity;$.version,$.build,$.device,$.version;var Z=function(e,t,n,o){return new(n||(n=Promise))(function(a,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function l(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(i,l)}c((o=o.apply(e,t||[])).next())})},ee=function(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(6===l[0]&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},et=h("transitionToGuild"),en=function(e,t,n,o,a){var r=a?n:t;E.show({title:"Update found",body:"A newer ".concat(a?"build":"version"," is available for ").concat(o.name,". ").concat(a?"\nThe version will remain at ".concat(t,", but the build will update to ").concat(n,"."):"","\nWould you like to install ").concat(a?"build `".concat(n,"`"):"version `".concat(t,"`"),"  now?"),confirmText:"Update",cancelText:"Not now",onConfirm:function(){return function(e,t,n,o){return Z(this,void 0,void 0,function(){return ee(this,function(a){return window.enmity.plugins.installPlugin(e,function(e){var a=e.data;"installed_plugin"==a||"overridden_plugin"==a?E.show({title:"Updated ".concat(n.name),body:"Successfully updated to ".concat(o?"build":"version"," `").concat(t,"`. \nWould you like to reload Discord now?"),confirmText:"Yep!",cancelText:"Not now",onConfirm:function(){$.reload()}}):E.show({title:"Error",body:"Something went wrong while updating ".concat(n.name,"."),confirmText:"Report this issue",cancelText:"Cancel",onConfirm:function(){et.openURL("https://github.com/spinfal/enmity-plugins/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D%20".concat(n.name,"%20Update%20Error%3A%20").concat(o?"b".concat(t):"v".concat(t)))}})}),[2]})})}(e,r,o,a)}})},eo=function(e,t){console.log("[".concat(e,"] Plugin is on the latest version, which is ").concat(t)),_.open({content:"".concat(e," is on latest version (").concat(t,")"),source:J.Success})},ea=window.enmity.modules.common.Components.General.Animated,er=p(f("transitionToGuild"),f("setString")),ei=er[0],el=er[1],ec=I.createThemedStyleSheet({container:{paddingTop:30,paddingLeft:20,marginBottom:-5,flexDirection:"row"},text_container:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap"},image:{width:75,height:75,borderRadius:10},main_text:{opacity:.975,letterSpacing:.25,fontFamily:y.Fonts.DISPLAY_NORMAL},header:{color:y.ThemeColorMap.HEADER_PRIMARY,fontFamily:y.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},sub_header:{color:y.ThemeColorMap.HEADER_SECONDARY,opacity:.975,fontSize:12.75}}),es=function(e){var t=e.manifest,n=b.useRef(new ea.Value(1)).current;return b.createElement(b.Fragment,null,b.createElement(c,{style:ec.container},b.createElement(l,{onPress:function(){ei.openURL("https://spin.rip/")},onPressIn:function(){ea.spring(n,{toValue:1.1,duration:250,useNativeDriver:!0}).start()},onPressOut:function(){ea.spring(n,{toValue:1,duration:250,useNativeDriver:!0}).start()}},b.createElement(ea.View,{style:[{transform:[{scale:n}]}]},b.createElement(a,{style:[ec.image],source:{uri:"https://cdn.spin.rip/r/l9uevwe4ia0.jpg"}}))),b.createElement(c,{style:ec.text_container},b.createElement(l,{onPress:function(){ei.openURL(t.sourceUrl)}},b.createElement(i,{style:[ec.main_text,ec.header]},t.name," ")),b.createElement(c,{style:{flexDirection:"row"}},b.createElement(i,{style:[ec.main_text,ec.sub_header]},"A plugin by"),b.createElement(l,{onPress:function(){ei.openURL("https://spin.rip/")}},b.createElement(i,{style:[ec.main_text,ec.sub_header,{paddingLeft:4,fontFamily:y.Fonts.DISPLAY_BOLD}]},t.authors[0].name))),b.createElement(c,{style:{flexDirection:"row"}},b.createElement(i,{style:[ec.main_text,ec.sub_header]},"Settings page by"),b.createElement(l,{onPress:function(){ei.openURL("https://github.com/acquitelol/")}},b.createElement(i,{style:[ec.main_text,ec.sub_header,{paddingLeft:4,fontFamily:y.Fonts.DISPLAY_BOLD}]},"Rosie<3"))),b.createElement(c,null,b.createElement(l,{style:{flexDirection:"row"},onPress:function(){el.setString("**".concat(t.name,"** v").concat(t.version)),X("plugin name and version")}},b.createElement(i,{style:[ec.main_text,ec.sub_header]},"Version:"),b.createElement(i,{style:[ec.main_text,ec.sub_header,{paddingLeft:4,fontFamily:y.Fonts.DISPLAY_BOLD}]},t.version," "))))))},eu=function(e,t,n,o){return new(n||(n=Promise))(function(a,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function l(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(i,l)}c((o=o.apply(e,t||[])).next())})},ed=function(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(6===l[0]&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},em=p(f("transitionToGuild","openURL"),f("setString","getString")),eg=em[0],ef=em[1],ep=I.createThemedStyleSheet({bottom_padding:{paddingBottom:25},icon:{color:y.ThemeColorMap.INTERACTIVE_NORMAL},item:{color:y.ThemeColorMap.TEXT_MUTED},text_container:{display:"flex",flexDirection:"column"}}),eh=function(e){var t=e.manifest,n=e.settings,o=e.hasToasts,a=e.children,i=e.commands;return b.createElement(r,null,b.createElement(es,{manifest:t}),a,i&&b.createElement(m,{title:"Plugin Commands"},i.map(function(e){return b.createElement(d,{label:"/".concat(e.name),subLabel:e.description,leading:b.createElement(d.Icon,{style:ep.icon,source:J.Settings.Commands}),trailing:d.Arrow,onPress:function(){ef.setString("/".concat(e.name)),X("the command ".concat(e.name))}})})),b.createElement(m,{title:"Utility"},o&&b.createElement(b.Fragment,null,b.createElement(d,{label:"Initialization Toasts",leading:b.createElement(d.Icon,{style:ep.icon,source:J.Settings.Toasts.Context}),subLabel:"If available, show toasts when ".concat(t.name," is starting"),trailing:b.createElement(g,{value:n.getBoolean("".concat(t.name,"-toastEnable"),!1),onValueChange:function(){n.toggle("".concat(t.name,"-toastEnable"),!1),_.open({content:"Successfully ".concat(n.getBoolean("".concat(t.name,"-toastEnable"),!1)?"enabled":"disabled"," initialization toasts."),source:J.Success})}})}),b.createElement(s,null)),b.createElement(d,{label:"Copy Debug Info",subLabel:"Copy useful debug information of ".concat(t.name," to clipboard."),leading:b.createElement(d.Icon,{style:ep.icon,source:J.Settings.Debug}),trailing:d.Arrow,onPress:function(){return eu(this,void 0,void 0,function(){var e,n;return ed(this,function(o){switch(o.label){case 0:return n=(e=ef).setString,[4,function(e,t,n){var o,a,r,i;return o=this,a=void 0,r=void 0,i=function(){var o;return Q(this,function(a){switch(a.label){case 0:return[4,function(){var e,t,n,o;return e=this,t=void 0,n=void 0,o=function(){var e,t,n;return q(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),[4,w.getItem("device_list")];case 1:if(e=o.sent())return[2,JSON.parse(e)];return[4,S.get("https://gist.githubusercontent.com/adamawolf/3048717/raw/1ee7e1a93dff9416f6ff34dd36b0ffbad9b956e9/Apple_mobile_device_types.txt")];case 2:return t=K(o.sent().text),[4,w.setItem("device_list",t)];case 3:return o.sent(),[4,w.getItem("device_list")];case 4:return[2,JSON.parse(o.sent())];case 5:return n=o.sent(),console.warn("[SpinsPlugins Local Error â€” Issue when getting devices: ".concat(n,"]")),[2];case 6:return[2]}})},new(n||(n=Promise))(function(a,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function l(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(i,l)}c((o=o.apply(e,t||[])).next())})}()];case 1:return o=a.sent(),[2,"**[".concat(e,"] Debug Information**\n> **Plugin Version:** ").concat(t,"\n> **Plugin Build:** ").concat(n.split("-")[1],"\n> **Discord Build:** ").concat(v.InfoDictionaryManager.Version," (").concat(v.InfoDictionaryManager.Build,")\n> **Software Version:** ").concat(v.DCDDeviceManager.systemVersion,"\n> **Device:** ").concat(o[v.DCDDeviceManager.device])]}})},new(r||(r=Promise))(function(e,t){function n(e){try{c(i.next(e))}catch(e){t(e)}}function l(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):((o=t.value)instanceof r?o:new r(function(e){e(o)})).then(n,l)}c((i=i.apply(o,a||[])).next())})}(t.name,t.version,t.build)];case 1:return n.apply(e,[o.sent()]),X("plugin debug information"),[2]}})})}}),b.createElement(s,null),b.createElement(d,{label:"Clear Device List Cache",subLabel:"Remove the fetched device list storage. This will not clear Discord's or your iDevice's cache.",leading:b.createElement(d.Icon,{style:ep.icon,source:J.Delete}),trailing:d.Arrow,onPress:function(){return eu(this,void 0,void 0,function(){return ed(this,function(e){switch(e.label){case 0:return[4,w.removeItem("device_list")];case 1:return e.sent(),_.open({content:"Cleared device list storage.",source:J.Success}),[2]}})})}})),b.createElement(m,{title:"Source"},b.createElement(d,{label:"Check for Updates",subLabel:"Check for any plugin updates for ".concat(t.name,"."),leading:b.createElement(d.Icon,{style:ep.icon,source:J.Copy}),trailing:d.Arrow,onPress:function(){!function(e){Z(this,arguments,void 0,function(e){var t,n,o,a,r=e.manifest;return ee(this,function(e){switch(e.label){case 0:return t="".concat(r.sourceUrl,"?").concat(Math.floor(1001*Math.random()),".js"),[4,S.get(t)];case 1:return[4,e.sent().text];case 2:if(o=(n=e.sent()).match(/\d\.\d\.\d+/g),a=n.match(/patch\-\d\.\d\.\d+/g),!o||!a)return[2,eo(r.name,r.version)];if(o=o[0],a=a[0],o!=r.version)return[2,en(t,o,a.split("-")[1],r,!1)];if(a!=r.build)return[2,en(t,o,a.split("-")[1],r,!0)];return[2,eo(r.name,r.version)]}})})}({manifest:t})}}),b.createElement(s,null),b.createElement(d,{label:"Source",subLabel:"View ".concat(t.name," source code"),leading:b.createElement(d.Icon,{style:ep.icon,source:J.Open}),trailing:d.Arrow,onPress:function(){eg.openURL("https://github.com/spinfal/enmity-plugins/tree/master/".concat(t.name))}})),b.createElement(d,{style:ep.bottom_padding,label:"Plugin Version: ".concat(t.version,"\nPlugin Build: ").concat(t.build.split("-").pop())}))},ey=function(){return(ey=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ev=function(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(6===l[0]&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};function eb(e,t,n,o){var a,r,i,l;return a=this,r=void 0,i=Promise,l=function(){var a,r,i;return ev(this,function(l){switch(l.label){case 0:return a={type:e,author:ey(ey({},t),{avatar:t.avatar?"https://cdn.discordapp.com/avatars/".concat(t.id,"/").concat(t.avatar,".").concat((null===(i=t.avatar)||void 0===i?void 0:i.startsWith("a_"))?"gif":"png","?size=1024"):"https://cdn.discordapp.com/embed/avatars/0.png"}),context:n,content:o.edited?[new Date(o.time).toLocaleString(),o.original,o.edited]:[new Date(o.time).toLocaleString(),o.original]},[4,w.getItem("NoDeleteLogs")];case 1:if(r=JSON.parse(r=l.sent()),a===r[r.length-1])return[2];return r.push(a),[4,w.setItem("NoDeleteLogs",JSON.stringify(r))];case 2:return l.sent(),[2]}})},new(i||(i=Promise))(function(e,t){function n(e){try{c(l.next(e))}catch(e){t(e)}}function o(e){try{c(l.throw(e))}catch(e){t(e)}}function c(t){var a;t.done?e(t.value):((a=t.value)instanceof i?a:new i(function(e){e(a)})).then(n,o)}c((l=l.apply(a,r||[])).next())})}var ew={};ew=JSON.parse('{"name":"Message Logger","version":"3.5.15","build":"patch-1.0.14","description":"PLs work","authors":[{"name":"vet","id":"305188557843070977"}],"color":"#000000","sourceUrl":"https://raw.githubusercontent.com/vetoul/enmity/refs/heads/main/index.js"}'),(P=U||(U={}))[P.BuiltIn=0]="BuiltIn",P[P.Guild=1]="Guild",P[P.DM=2]="DM",(M=j||(j={}))[M.Chat=1]="Chat",M[M.User=2]="User",M[M.Message=3]="Message",(B=V||(V={}))[B.BuiltIn=0]="BuiltIn",B[B.BuiltInText=1]="BuiltInText",B[B.BuiltInIntegration=2]="BuiltInIntegration",B[B.Bot=3]="Bot",B[B.Placeholder=4]="Placeholder",(N=G||(G={}))[N.Role=1]="Role",N[N.User=2]="User",(O=Y||(Y={}))[O.SubCommand=1]="SubCommand",O[O.SubCommandGroup=2]="SubCommandGroup",O[O.String=3]="String",O[O.Integer=4]="Integer",O[O.Boolean=5]="Boolean",O[O.User=6]="User",O[O.Channel=7]="Channel",O[O.Role=8]="Role",O[O.Mentionnable=9]="Mentionnable",O[O.Number=10]="Number",O[O.Attachment=11]="Attachment",(R=H||(H={}))[R.ApplicationCommand=2]="ApplicationCommand",R[R.MessageComponent=3]="MessageComponent";var e_=function(){return(e_=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},eE=D.createStackNavigator(),eS=L.ThemeColorMap,ex=I.createThemedStyleSheet({container:{backgroundColor:eS.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:eS.BACKGROUND_MOBILE_PRIMARY,color:eS.TEXT_NORMAL},header:{backgroundColor:eS.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:eS.HEADER_PRIMARY},close:{color:eS.HEADER_PRIMARY}}),eC=function(e){var t=void 0===e?{}:e,n=t.name,a=void 0===n?"Page":n,r=t.component,i=void 0===r?c:r,l=t.close_button,s=void 0===l?{name:"Close",functionality:function(){C.pop()}}:l;return b.createElement(T.NavigationContainer,{independent:!0},b.createElement(eE.Navigator,{initialRouteName:a,style:ex.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:ex.cardStyle,headerStyle:ex.header,headerTitleContainerStyle:ex.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},b.createElement(eE.Screen,{name:a,component:i,options:e_({headerTitleStyle:{color:"white"},headerLeft:function(){return b.createElement(o,{color:ex.close.color,title:s.name,onPress:s.functionality})}},D.TransitionPresets.ModalSlideFromBottomIOS)})))},eT=p(f("setString"),f("fetchProfile")),eD=eT[0],eI=eT[1],eL=function(...e){return window.enmity.modules.getByName(...e)}("StaticSearchBarContainer"),eA=I.createThemedStyleSheet({main_text:{opacity:.975,letterSpacing:.25,fontFamily:y.Fonts.DISPLAY_NORMAL},item_container:{display:"flex",flexDirection:"row",alignItems:"center",paddingTop:4,paddingBottom:4,width:"100%"},author_name:{color:y.ThemeColorMap.HEADER_PRIMARY,fontFamily:y.Fonts.DISPLAY_BOLD,fontSize:18,letterSpacing:.25,paddingBottom:4},log_header:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",maxWidth:"95%"},log_sub_header:{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"50%"},log_time:{color:y.ThemeColorMap.TEXT_MUTED,opacity:.99,fontSize:13,paddingLeft:4},log_type:{color:y.ThemeColorMap.TEXT_MUTED,opacity:.45,fontSize:16,marginLeft:"auto"},avatar_container:{alignSelf:"start",justifySelf:"start",marginTop:5},author_avatar:{width:40,height:40,borderRadius:100},old_message:{color:y.ThemeColorMap.TEXT_MUTED,opacity:.89,fontSize:16},message_content:{color:y.ThemeColorMap.TEXT_NORMAL,opacity:.985,fontSize:16},main_container:{paddingLeft:8,paddingRight:4,paddingTop:2,paddingBottom:16,width:"95%"},text_container:{display:"flex",flexDirection:"column",paddingBottom:4,paddingLeft:8,width:"95%"}}),eP=function(){var e,t,n,o,u,m=function(e,t){return e.length>t?e.substring(0,t)+"...":e},g=function(){w.setItem("NoDeleteLogs","[]"),w.getItem("NoDeleteLogs").then(function(e){"[]"==e?E.show({title:"Logs Cleared",body:"NoDelete message logs have been cleared",confirmText:"Close logs",cancelText:"Cancel",onConfirm:function(){return C.pop()}}):E.show({title:"Error clearing logs",body:"NoDelete logs could not be cleared. Try again or report this issues to spin.",confirmText:"Close logs",cancelText:"Cancel",onConfirm:function(){return C.pop()}})})},f=(e="_nodelete",t="maxLogs",n="1000",window.enmity.settings.get(e,t,n)),p=b.useState([]),h=p[0],y=p[1],v=b.useState([]),S=v[0],T=v[1];b.useEffect(function(){w.getItem("NoDeleteLogs").then(function(e){y(JSON.parse(e).reverse())})},[]);for(var D=0;D<h.length;D++)void 0==h[D].author.id&&(h[D]={type:h[D].type,author:{username:h[D].author,id:h[D].id,avatar:h[D].avatar,bot:"unknown"},context:{guild:"unknown",channel:"unknown",message:"unknown"},content:h[D].content},D==h.length-1&&y(h));return h.length>parseInt(f)&&(!1==(o="_nodelete",u="autoClear",window.enmity.settings.getBoolean(o,u,!1))?E.show({title:"Logs have exceeded ".concat(m(f,12)),body:"NoDelete logs have exceeded your limit of ".concat(m(f,12)).concat(parseInt(f)>1e3?"\nYou may experience performance issues or a laggy log page UI. Clear your logs to fix this issue.":""),confirmText:"Clear logs",cancelText:"Close",onConfirm:function(){return g()}}):(g(),w.getItem("NoDeleteLogs").then(function(e){"[]"===e?_.open({content:"Auto-cleared ".concat(m(h.length,10)," logs."),source:J.Success}):_.open({content:"NoDelete logs could not be cleared. Try again or report this issues to spin.",source:J.Failed})}))),b.createElement(b.Fragment,null,b.createElement(eL,{placeholder:"Search Logs",onChangeText:function(e){return T(e)}}),b.createElement(d,{label:"Clear all NoDelete message logs",trailing:d.Arrow,onPress:function(){return g()}}),b.createElement(s,null),b.createElement(r,null,b.createElement(c,{style:eA.main_container},h.filter(function(e){return JSON.stringify(e).includes(S)}).map(function(e){return b.createElement(b.Fragment,null,b.createElement(c,{style:eA.item_container},b.createElement(l,{onPress:function(){x.getUser(e.author.id)?A.showUserProfile({userId:e.author.id}):eI.getUser(e.author.id).then(function(){return A.showUserProfile({userId:e.author.id})})},style:eA.avatar_container},b.createElement(a,{style:eA.author_avatar,source:{uri:e.author.avatar}})),b.createElement(l,{onPress:function(){eD.setString("".concat(e.author.username," (`").concat(e.author.id,"`):\n>>> ").concat(e.content.join("\n"))),X("log content")},style:eA.text_container},b.createElement(c,{style:eA.log_header},b.createElement(c,{style:eA.log_sub_header},b.createElement(i,{style:[eA.main_text,eA.author_name]},e.author.username),b.createElement(i,{style:[eA.main_text,eA.log_time]},e.content[0])),b.createElement(i,{style:[eA.main_text,eA.log_type]},"edit"===e.type?b.createElement(d.Icon,{source:J.Pencil}):b.createElement(d.Icon,{source:J.Delete}))),b.createElement(c,null,3==e.content.length?b.createElement(b.Fragment,null,b.createElement(i,{style:[eA.main_text,eA.old_message]},e.content[1]),b.createElement(i,{style:[eA.main_text,eA.message_content]},e.content[2])):b.createElement(i,{style:eA.message_content},e.content[1])))),b.createElement(s,null))}))))},eM=function(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(6===l[0]&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},eB=[{id:"logs-command",name:"logs",displayName:"logs",description:"Open the NoDelete message logs page",displayDescription:"Open the NoDelete message logs page",type:j.Chat,inputType:V.BuiltInText,execute:function(e,t){var n,o,a,r;return n=this,o=void 0,a=void 0,r=function(){var e;return eM(this,function(n){try{C.push(eC,{component:eP,name:"NoDelete Message Logs"})}catch(n){var o,a;console.log("[ NoDelete Error ]",n),o=null!==(e=null==t?void 0:t.channel.id)&&void 0!==e?e:"0",a="An error occured while trying to open NoDelete message logs. Check debug logs for more info.",window.enmity.clyde.sendReply(o,a,void 0,void 0)}return[2]})},new(a||(a=Promise))(function(e,t){function i(e){try{c(r.next(e))}catch(e){t(e)}}function l(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):((n=t.value)instanceof a?n:new a(function(e){e(n)})).then(i,l)}c((r=r.apply(n,o||[])).next())})}}],eN=function(e){var t=e.styles,n=T.useNavigation();return b.createElement(m,{title:"Message Logs"},b.createElement(d,{label:"View Message Logs",subLabel:"Tap on an item to copy to clipboard",leading:b.createElement(d.Icon,{style:t.icon,source:J.Settings.Debug}),onPress:function(){n.push("EnmityCustomPage",{pageName:"NoDelete Message Logs",pagePanel:eP})}}))},eO=function(){return(eO=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},eR=I.createThemedStyleSheet({icon:{color:y.ThemeColorMap.INTERACTIVE_NORMAL},item:{color:y.ThemeColorMap.TEXT_MUTED}}),ek=(k=/*@__PURE__*/e(ew).name,window.enmity.patcher.create(k));F=eO(eO({},/*@__PURE__*/e(ew)),{patches:[],onStart:function(){w.getItem("NoDeleteLogs").then(function(e){null==e&&w.setItem("NoDeleteLogs","[]")}).catch(function(t){console.log("[".concat(/*@__PURE__*/e(ew).name," Storage Error]"),t)});var t,n,o,a=h("_currentDispatchActionType","_subscriptions","_actionHandlers","_waitQueue"),r=h("getMessage","getMessages"),i=h("getChannel","getDMFromUserId");null===(t=x.getCurrentUser())||void 0===t||t.id;var l=function(e){var t,n,o,l,c,s,u,d=r.getMessage(e[0].channelId,e[0].id);if(d&&d.content){var m=eO(eO({},d),{content:'<span style="color:red;">[Deleted] '.concat(null==d?void 0:d.content,"</span>")});a.dispatch({type:"MESSAGE_UPDATE",message:m}),eb("delete",{username:"".concat(null===(t=null==d?void 0:d.author)||void 0===t?void 0:t.username,"#").concat(null===(n=null==d?void 0:d.author)||void 0===n?void 0:n.discriminator),id:null===(o=null==d?void 0:d.author)||void 0===o?void 0:o.id,avatar:null===(l=null==d?void 0:d.author)||void 0===l?void 0:l.avatar,bot:null===(c=null==d?void 0:d.author)||void 0===c?void 0:c.bot},{guild:null===(s=i.getChannel(null==d?void 0:d.channel_id))||void 0===s?void 0:s.guild_id,channel:null==d?void 0:d.channel_id,message:null==d?void 0:d.id},{time:null==d?void 0:d.timestamp,original:null===(u=null==d?void 0:d.content)||void 0===u?void 0:u.replace("`[deleted]`","").trim()})}};ek.after(null===(n=a._actionHandlers._orderedActionHandlers)||void 0===n?void 0:n.MESSAGE_DELETE.find(function(e){return"MessageStore"===e.name}),"actionHandler",function(e,t){l(t)});var c=function(e){var t,n,o,a,i,l,c,s,u,d,m,g,f,p,h,y,v,b,w,_,E,S,x=r.getMessage(e[0].message.channel_id,e[0].message.id);if(x&&(null===(n=null===(t=e[0])||void 0===t?void 0:t.message)||void 0===n?void 0:n.content)){var C=e[0].message.content;e[0].message.content='\n                <span style="color:gray; opacity:0.7;">'.concat(null==x?void 0:x.content,"</span>\n                <br />\n                <span>").concat(C,"</span>"),eb("edit",{username:"".concat(null===(i=null===(a=null===(o=e[0])||void 0===o?void 0:o.message)||void 0===a?void 0:a.author)||void 0===i?void 0:i.username,"#").concat(null===(s=null===(c=null===(l=e[0])||void 0===l?void 0:l.message)||void 0===c?void 0:c.author)||void 0===s?void 0:s.discriminator),id:null===(m=null===(d=null===(u=e[0])||void 0===u?void 0:u.message)||void 0===d?void 0:d.author)||void 0===m?void 0:m.id,avatar:null===(p=null===(f=null===(g=e[0])||void 0===g?void 0:g.message)||void 0===f?void 0:f.author)||void 0===p?void 0:p.avatar,bot:null===(v=null===(y=null===(h=e[0])||void 0===h?void 0:h.message)||void 0===y?void 0:y.author)||void 0===v?void 0:v.bot},{guild:e[0].message.guild_id,channel:e[0].message.channel_id,message:e[0].message.id},{time:null===(w=null===(b=e[0])||void 0===b?void 0:b.message)||void 0===w?void 0:w.edited_timestamp,original:null===(E=null===(_=null==x?void 0:x.content)||void 0===_?void 0:_.replace(/\`\[edited\]\`/gim,""))||void 0===E?void 0:E.replace("`[deleted]`","").trim(),edited:"".concat(null===(S=null==C?void 0:C.replace(/\`\[edited\]\`/gim,""))||void 0===S?void 0:S.replace("`[deleted]`","").trim())})}};ek.before(null===(o=a._actionHandlers._orderedActionHandlers)||void 0===o?void 0:o.MESSAGE_UPDATE.find(function(e){return"MessageStore"===e.name}),"actionHandler",function(e,t){c(t)}),this.commands=eB},onStop:function(){ek.unpatchAll(),this.commands=[]},getSettingsPanel:function(n){var o=n.settings;return b.createElement(eh,{manifest:/*@__PURE__*/e(ew),settings:o,hasToasts:!1,commands:eB},b.createElement(eN,{styles:eR}),b.createElement(s,null),b.createElement(m,{title:"Plugin Settings"},b.createElement(d,{label:"Log bot messages",subLabel:"Whether or not bot message events should be logged",leading:b.createElement(d.Icon,{source:J.Settings.Robot}),trailing:b.createElement(g,{value:o.getBoolean("_nodelete_logBots",!1),onValueChange:function(){try{o.toggle("_nodelete_logBots",!1),t("_nodelete","_logBots",o.getBoolean("_nodelete_logBots",!1)),_.open({content:"Log bot messages has been ".concat(o.getBoolean("_nodelete_logBots",!1)?"enabled":"disabled","."),source:J.Success})}catch(e){console.log("[ NoDelete Toggle Error ]",e),_.open({content:"An error occurred. Check debug logs for more info.",source:J.Failed})}}})}),b.createElement(s,null),b.createElement(d,{label:"Log my own messages",subLabel:"Whether or not your own edits and deleted messages will be logged",leading:b.createElement(d.Icon,{source:J.Settings.Self}),trailing:b.createElement(g,{value:o.getBoolean("_nodelete_logSelf",!1),onValueChange:function(){try{o.toggle("_nodelete_logSelf",!1),t("_nodelete","_logSelf",o.getBoolean("_nodelete_logSelf",!1)),_.open({content:"Log my own messages has been ".concat(o.getBoolean("_nodelete_logSelf",!1)?"enabled":"disabled","."),source:J.Success})}catch(e){console.log("[ NoDelete Toggle Error ]",e),_.open({content:"An error occurred. Check debug logs for more info.",source:J.Failed})}}})}),b.createElement(s,null),b.createElement(d,{label:"Only log to Storage",subLabel:"Message logs will not show in chat, only in Storage",leading:b.createElement(d.Icon,{source:J.Pencil}),trailing:b.createElement(g,{value:o.getBoolean("_nodelete",!1),onValueChange:function(){try{o.toggle("_nodelete",!1),t("_nodelete","_storageLog",o.getBoolean("_nodelete",!1)),_.open({content:"Storage-only logging has been ".concat(o.getBoolean("_nodelete",!1)?"enabled":"disabled","."),source:J.Success})}catch(e){console.log("[ NoDelete Toggle Error ]",e),_.open({content:"An error occurred. Check debug logs for more info.",source:J.Failed})}}})}),b.createElement(s,null),b.createElement(u,{value:o.getBoolean("_nodelete_maxLogs","1000"),onChange:function(e){return/^\d+$/.test(e)?t("_nodelete","maxLogs",e.trim()):t("_nodelete","maxLogs","1000")},title:"Max Logs to Store"}),b.createElement(d,{label:"Auto-clear logs",subLabel:"Message logs will automatically clear after they have exceeded your max logs limit",leading:b.createElement(d.Icon,{source:J.Clear}),trailing:b.createElement(g,{value:o.getBoolean("_nodelete_autoClear",!1),onValueChange:function(){try{o.toggle("_nodelete_autoClear",!1),t("_nodelete","autoClear",o.getBoolean("_nodelete_autoClear",!1)),_.open({content:"Auto-clear logs has been ".concat(o.getBoolean("_nodelete_autoClear",!1)?"enabled":"disabled","."),source:J.Success})}catch(e){console.log("[ NoDelete Toggle Error ]",e),_.open({content:"An error occurred. Check debug logs for more info.",source:J.Failed})}}})})))}}),window.enmity.plugins.registerPlugin(F)})();
//# sourceMappingURL=index.js.map
